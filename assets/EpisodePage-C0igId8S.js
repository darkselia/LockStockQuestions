import{j as E,p as g,B as s,J as i,x as b,W as $,z as c,s as r,l as d,D as Q,q as l,d as C,r as B,k as j,n as H,C as J,F as V,L as O,v as k,X as U,M as W}from"./vendor-vue-BScu_Utx.js";import{_ as F,u as X}from"./index-W_Z2SLPb.js";import"./vendor-DHuvzb8L.js";const G={class:"detail"},K={class:"detail-label"},Y={class:"detail-content"},Z=E({__name:"DetailItem",props:{label:{},text:{},revealed:{type:Boolean},skeletonType:{},onReveal:{type:Function}},setup(o){return(p,q)=>{const R=d("v-skeleton-loader");return l(),g("div",G,[s("span",K,i(o.label),1),s("div",Y,[b($,{name:"detail-fade",mode:"out-in"},{default:c(()=>[o.revealed?(l(),g("span",{key:"text",class:Q([o.skeletonType,"detail-value"])},i(o.text),3)):(l(),r(R,{key:"skeleton",type:o.skeletonType,boilerplate:"",class:"spoiler-skeleton",onClick:o.onReveal},null,8,["type","onClick"]))]),_:1})])])}}}),w=F(Z,[["__scopeId","data-v-35eb5bd0"]]),ee={class:"page-shell"},te={class:"page-header"},ne={key:0,class:"empty-state"},ae={class:"panel-title"},se={class:"panel-index"},le={class:"panel-question"},oe={class:"answer-card"},re=E({__name:"EpisodePage",setup(o){const p=U(),q=W(),R=X(),T=C(()=>String(p.params.id??"")),v=C(()=>R.getByVideo(T.value)??[]),M=new Set(v.value.map(e=>String(e["question-id"]))),y=B([]),I=C({get(){return y.value},set(e){const t=Array.from(new Set(e.map(a=>String(a)))).filter(a=>M.has(a));t.sort((a,f)=>a.localeCompare(f,void 0,{numeric:!0}));const _=new Set(t),u=y.value.filter(a=>!_.has(a));D(u),y.value=t,z(t)}}),m=B({});v.value.forEach(e=>{m.value[String(e["question-id"])]={hint1:!1,hint2:!1,answer:!1}});function h(e,t){return!!m.value[e]?.[t]}function P(e,t){m.value[e]&&(m.value[e][t]=!0)}function x(e,t){return function(){P(e,t)}}function z(e){const t={...p.query};e.length?t.questions=e.join(","):delete t.questions,q.replace({name:"episode",params:p.params,query:t}).catch(function(){})}function A(){const e=p.query.questions,t=typeof e=="string"?e.split(","):Array.isArray(e)?e.flatMap(function(a){return String(a)}):[],_=new Set(v.value.map(function(a){return String(a["question-id"])})),u=Array.from(new Set(t)).filter(function(a){return _.has(a)}).sort(function(a,f){return a.localeCompare(f,void 0,{numeric:!0})});return y.value=u,u}function D(e){e.forEach(function(t){m.value[t]={hint1:!1,hint2:!1,answer:!1}})}function S(e){return e==null||e==="-"?!1:String(e).trim().length>0}return j(()=>{const e=A();if(I.value=e,e.length===1){const t="question-"+e[0];H(function(){document.getElementById(t)?.scrollIntoView({behavior:"smooth"})})}}),(e,t)=>{const _=d("v-alert"),u=d("v-expansion-panel-title"),a=d("v-expansion-panel-text"),f=d("v-expansion-panel"),L=d("v-expansion-panels");return l(),g(V,null,[b(_,{closable:"",type:"info",border:"start",elevation:"2",class:"episode-alert",icon:"mdi-information"},{default:c(()=>[...t[1]||(t[1]=[J(" Если вы заметили ошибку в вопросе, пожалуйста, напишите на почту снизу страницы с указанием номера выпуска, номера вопроса и описанием ошибки. ",-1)])]),_:1}),s("section",ee,[s("header",te,[t[2]||(t[2]=s("p",{class:"eyebrow"},"Выпуск",-1)),s("h1",null,"№ "+i(T.value),1),t[3]||(t[3]=s("p",{class:"subtitle"},"Вопросы, подсказки и ответы из шоу LockStock",-1))]),v.value.length?(l(),r(L,{key:1,modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=n=>I.value=n),multiple:"",variant:"popout"},{default:c(()=>[(l(!0),g(V,null,O(v.value,(n,N)=>(l(),r(f,{key:n["question-id"],value:String(n["question-id"]),id:"question-"+n["question-id"],class:"question-panel"},{default:c(()=>[b(u,null,{default:c(()=>[s("div",ae,[s("span",se,i(N+1),1),s("span",le,i(n.question),1),s("span",null,i(n["question-id"]),1)])]),_:2},1024),b(a,null,{default:c(()=>[s("div",oe,[S(n.hint1)?(l(),r(w,{key:0,text:String(n.hint1??""),revealed:h(String(n["question-id"]),"hint1"),onReveal:x(String(n["question-id"]),"hint1"),label:"Подсказка 1",skeletonType:"sentences"},null,8,["text","revealed","onReveal"])):k("",!0),S(n.hint2)?(l(),r(w,{key:1,text:String(n.hint2??""),revealed:h(String(n["question-id"]),"hint2"),onReveal:x(String(n["question-id"]),"hint2"),label:"Подсказка 2",skeletonType:"sentences"},null,8,["text","revealed","onReveal"])):k("",!0),S(n.answer)?(l(),r(w,{key:2,text:String(n.answer??""),revealed:h(String(n["question-id"]),"answer"),onReveal:x(String(n["question-id"]),"answer"),label:"Ответ",skeletonType:"list-item"},null,8,["text","revealed","onReveal"])):k("",!0),S(n["answer-comm"])?(l(),r(w,{key:3,text:String(n["answer-comm"]??""),revealed:h(String(n["question-id"]),"answer"),onReveal:x(String(n["question-id"]),"answer"),label:"Комментарий к ответу",skeletonType:"paragraph"},null,8,["text","revealed","onReveal"])):k("",!0)])]),_:2},1024)]),_:2},1032,["value","id"]))),128))]),_:1},8,["modelValue"])):(l(),g("div",ne,[s("p",null,"Для выпуска № "+i(T.value)+" вопросов не загружено.",1)]))])],64)}}}),de=F(re,[["__scopeId","data-v-6a4260ae"]]);export{de as default};
