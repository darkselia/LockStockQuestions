import{j as V,p as g,q as l,B as s,Q as i,x as q,V as Q,z as _,s as r,l as f,D as $,d as I,r as C,k as L,n as N,W as j,F as H,S as O,v as k,T as U}from"./vendor-vue-CE30jCqi.js";import{_ as E,u as W}from"./index-DJsOZUxf.js";import"./vendor-CnKIah0l.js";const G={class:"detail"},J={class:"detail-label"},K={class:"detail-content"},X=V({__name:"DetailItem",props:{label:{},text:{},revealed:{type:Boolean},skeletonType:{},onReveal:{type:Function}},setup(o){return(c,B)=>{const R=f("v-skeleton-loader");return l(),g("div",G,[s("span",J,i(o.label),1),s("div",K,[q(Q,{name:"detail-fade",mode:"out-in"},{default:_(()=>[o.revealed?(l(),g("span",{key:"text",class:$([o.skeletonType,"detail-value"])},i(o.text),3)):(l(),r(R,{key:"skeleton",type:o.skeletonType,boilerplate:"",class:"spoiler-skeleton",onClick:o.onReveal},null,8,["type","onClick"]))]),_:1})])])}}}),w=E(X,[["__scopeId","data-v-35eb5bd0"]]),Y={class:"page-shell"},Z={class:"page-header"},ee={key:0,class:"empty-state"},te={class:"panel-title"},ne={class:"panel-index"},ae={class:"panel-question"},se={class:"answer-card"},le=V({__name:"EpisodePage",setup(o){const c=j(),B=U(),R=W(),b=I(()=>String(c.params.id??"")),d=I(()=>R.getByVideo(b.value)??[]),F=new Set(d.value.map(e=>String(e["question-id"]))),h=C([]),T=I({get(){return h.value},set(e){const t=Array.from(new Set(e.map(a=>String(a)))).filter(a=>F.has(a));t.sort((a,m)=>a.localeCompare(m,void 0,{numeric:!0}));const v=new Set(t),u=h.value.filter(a=>!v.has(a));D(u),h.value=t,z(t)}}),p=C({});d.value.forEach(e=>{p.value[String(e["question-id"])]={hint1:!1,hint2:!1,answer:!1}});function y(e,t){return!!p.value[e]?.[t]}function P(e,t){p.value[e]&&(p.value[e][t]=!0)}function S(e,t){return function(){P(e,t)}}function z(e){const t={...c.query};e.length?t.questions=e.join(","):delete t.questions,B.replace({name:"episode",params:c.params,query:t}).catch(function(){})}function A(){const e=c.query.questions,t=typeof e=="string"?e.split(","):Array.isArray(e)?e.flatMap(function(a){return String(a)}):[],v=new Set(d.value.map(function(a){return String(a["question-id"])})),u=Array.from(new Set(t)).filter(function(a){return v.has(a)}).sort(function(a,m){return a.localeCompare(m,void 0,{numeric:!0})});return h.value=u,u}function D(e){e.forEach(function(t){p.value[t]={hint1:!1,hint2:!1,answer:!1}})}function x(e){return e==null||e==="-"?!1:String(e).trim().length>0}return L(()=>{const e=A();if(T.value=e,e.length===1){const t="question-"+e[0];N(function(){document.getElementById(t)?.scrollIntoView({behavior:"smooth"})})}}),(e,t)=>{const v=f("v-expansion-panel-title"),u=f("v-expansion-panel-text"),a=f("v-expansion-panel"),m=f("v-expansion-panels");return l(),g("section",Y,[s("header",Z,[t[1]||(t[1]=s("p",{class:"eyebrow"},"Выпуск",-1)),s("h1",null,"№ "+i(b.value),1),t[2]||(t[2]=s("p",{class:"subtitle"},"Вопросы, подсказки и ответы из шоу LockStock",-1))]),d.value.length?(l(),r(m,{key:1,modelValue:T.value,"onUpdate:modelValue":t[0]||(t[0]=n=>T.value=n),multiple:"",variant:"popout"},{default:_(()=>[(l(!0),g(H,null,O(d.value,(n,M)=>(l(),r(a,{key:n["question-id"],value:String(n["question-id"]),id:"question-"+n["question-id"],class:"question-panel"},{default:_(()=>[q(v,null,{default:_(()=>[s("div",te,[s("span",ne,i(M+1),1),s("span",ae,i(n.question),1),s("span",null,i(n["question-id"]),1)])]),_:2},1024),q(u,null,{default:_(()=>[s("div",se,[x(n.hint1)?(l(),r(w,{key:0,text:String(n.hint1??""),revealed:y(String(n["question-id"]),"hint1"),onReveal:S(String(n["question-id"]),"hint1"),label:"Подсказка 1",skeletonType:"sentences"},null,8,["text","revealed","onReveal"])):k("",!0),x(n.hint2)?(l(),r(w,{key:1,text:String(n.hint2??""),revealed:y(String(n["question-id"]),"hint2"),onReveal:S(String(n["question-id"]),"hint2"),label:"Подсказка 2",skeletonType:"sentences"},null,8,["text","revealed","onReveal"])):k("",!0),x(n.answer)?(l(),r(w,{key:2,text:String(n.answer??""),revealed:y(String(n["question-id"]),"answer"),onReveal:S(String(n["question-id"]),"answer"),label:"Ответ",skeletonType:"list-item"},null,8,["text","revealed","onReveal"])):k("",!0),x(n["answer-comm"])?(l(),r(w,{key:3,text:String(n["answer-comm"]??""),revealed:y(String(n["question-id"]),"answer"),onReveal:S(String(n["question-id"]),"answer"),label:"Комментарий к ответу",skeletonType:"paragraph"},null,8,["text","revealed","onReveal"])):k("",!0)])]),_:2},1024)]),_:2},1032,["value","id"]))),128))]),_:1},8,["modelValue"])):(l(),g("div",ee,[s("p",null,"Для выпуска № "+i(b.value)+" вопросов не загружено.",1)]))])}}}),ue=E(le,[["__scopeId","data-v-e0b8762d"]]);export{ue as default};
